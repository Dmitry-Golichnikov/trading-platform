# Focal Loss

## Назначение
Модификация Cross-Entropy, уменьшающая вклад лёгких примеров и усиливающая обучение на сложных или редких классах. Полезна при сильном дисбалансе long/short сигналов.

## Формула
\( FL = -\alpha (1 - \hat{p})^{\gamma} y \log(\hat{p}) - (1 - \alpha) \hat{p}^{\gamma} (1 - y) \log(1 - \hat{p}) \)

## Особенности
- Параметр \(\gamma\) управляет степенью фокусировки: чем выше, тем сильнее подавляются «лёгкие» примеры.
- Коэффициент \(\alpha\) позволяет балансировать классы.
- Есть варианты для мультиклассовых задач и софтметрик.

## Рекомендации
- Подбирать \(\gamma\) и \(\alpha\) под конкретный дисбаланс (например, \(\gamma = 2\), \(\alpha = 0.25\)).
- Хорошо сочетается с детекторами редких событий (пробои, аномалии).
- Для многоклассовых задач используйте вектор `alpha`, задающий веса для каждого класса (long/flat/short).
