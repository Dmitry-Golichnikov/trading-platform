# Multiclass Cross-Entropy

## Назначение
Используется для многоклассовых задач (например, long / flat / short). В PyTorch реализована как `CrossEntropyLoss` и объединяет логиты и softmax.

## Формула
\( CE(y, \hat{p}) = -\frac{1}{N} \sum_{i=1}^{N} \sum_{c=1}^{C} y_{ic} \log \hat{p}_{ic} \)

## Особенности
- Поддерживает классовые веса (`weight`), игнорирование классов (`ignore_index`).
- Предполагает, что выход модели — логиты для каждого класса.
- Чувствительна к дисбалансу (использовать веса или Focal Loss).

## Рекомендации
- Применять при одновременном прогнозе long/flat/short.
- Настраивать `class_weight`/`weight`, если один из классов (например, short) встречается редко.
- Для сценариев с большим перекосом в сторону flat добавляйте веса или рассматривайте подбор порогов поверх вероятностей.
