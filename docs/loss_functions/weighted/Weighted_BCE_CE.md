# Weighted BCE / Cross-Entropy

## Назначение
Вариация стандартных BCE/CE, учитывающая разные веса классов. Применяется для компенсации дисбаланса сигналов (например, редкие short-события) или различной стоимости ошибок.

## Формула
Для BCE: \( \text{loss} = -w_{pos} y \log \hat{p} - w_{neg} (1 - y) \log(1 - \hat{p}) \).

## Особенности
- Позволяет усилить вклад редких классов в градиенты.
- Вес может задаваться глобально (параметры `pos_weight`, `weight`) или динамически из данных.
- В многоклассовом случае веса можно задавать для каждого класса.

## Рекомендации
- Рассчитывать веса как обратную долю класса или по стоимости ошибки (например, ложный long > ложный short).
- Комбинировать с Focal Loss для ещё большей фокусировки на сложных примерах.
