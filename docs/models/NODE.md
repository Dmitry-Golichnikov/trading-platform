# NODE (Neural Oblivious Decision Ensembles)

## Назначение
Нейросетевой ансамбль обливиус-деревьев, предназначенный для табличных данных. Используется для выявления нелинейных зависимостей и построения прогнозов по направлениям long/short.

## Ключевые особенности
- Сочетает преимущества деревьев и нейросетей: дифференцируемые сплиты и нелинейные взаимодействия.
- Обучается через backpropagation на GPU, поддерживает end-to-end оптимизацию.
- Поддерживает бинарную и мультиклассовую классификацию (long-only, short-only, long+short).

## Типичные гиперпараметры
- `num_layers`, `num_trees`: глубина ансамбля и количество деревьев в слое.
- `tree_dim`: размерность листьев (число выходных каналов).
- `dropout`, `batch_size`, `learning_rate`, `optimizer`.
- `sparsity_regularization`: контроль разреженности сплитов.

## Требования к данным
- Признаки желательно нормализовать/стандартизовать.
- Обработка пропусков — через заполнение или отдельные индикаторы пропуска.
- Для однонаправленных задач фильтровать таргеты перед обучением.

## Метрики и валидация
- Accuracy, F1, ROC-AUC, трейдинговые метрики (Sharpe, Hit Rate).
- Ранняя остановка и мониторинг валидационного лосса.
- Walk-forward/expanding window валидация.

## Интеграция в конвейер
- Реализация на PyTorch с соблюдением интерфейса `fit/predict/predict_proba`.
- Логирование весов сплитов и важности признаков (средние маски).
- Сохранять чекпоинты модели и метаданные обучения (оптимизатор, эпохи).

## Ограничения и рекомендации
- Модель относительно новая, требует аккуратного подбора гиперпараметров.
- Может переобучаться на шумных данных; использовать регуляризацию и dropout.
- Использовать в связке с линейными/бустинговыми baseline-ами для сравнения.
