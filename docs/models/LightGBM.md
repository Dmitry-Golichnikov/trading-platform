# LightGBM

## Назначение
Градиентный бустинг по листьям для табличных данных с числовыми и категориальными признаками, эффективен для прогнозирования направленных сигналов long/short.

## Ключевые особенности
- Высокая скорость обучения и предсказания, поддержка GPU.
- Встроенная работа с пропусками, категориальными фичами и неравномерными распределениями.
- Гибкая настройка весов классов и кастомных метрик для трейдинговых задач.

## Типичные гиперпараметры
- `num_leaves`, `max_depth`: контролируют сложность деревьев.
- `learning_rate`: темп обучения.
- `feature_fraction`, `bagging_fraction`, `bagging_freq`: стохастический контроль переобучения.
- `min_data_in_leaf`, `lambda_l1`, `lambda_l2`: регуляризация.
- `objective`: binary, multiclass или custom loss для long-only/short-only/long+short сценариев.

## Требования к данным
- Необязательно строгая нормализация признаков, но полезна для стабильности.
- Для режимов long-only или short-only фильтруйте таргеты перед обучением.
- Для мультиклассовых задач (long, flat, short) задайте корректные классы и веса.

## Метрики и валидация
- ROC-AUC, PR-AUC, F1, а также трейдинговые метрики (Sharpe, Profit Factor).
- Поддержка кастомных метрик через интерфейс LightGBM.
- Walk-forward или тайм-сенситивная кросс-валидация.

## Интеграция в конвейер
- Использует стандартный интерфейс `fit/predict/predict_proba`.
- Логировать важность признаков (gain/split), хранить модели в бинарном формате.
- Для GPU-ускорения убедиться в наличии CUDA и правильной сборки LightGBM.

## Ограничения и рекомендации
- Чувствителен к качеству и количеству категориальных признаков — при необходимости использовать таргет-кодирование.
- Требует подбора гиперпараметров для каждого режима (long-only/short-only/multi-class).
- Может переобучаться на шумных данных; использовать раннюю остановку и регуляризацию.
