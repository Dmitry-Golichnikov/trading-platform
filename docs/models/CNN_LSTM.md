# 1D-CNN + LSTM гибрид

## Назначение
Комбинированная архитектура, где одномерные свёртки извлекают локальные паттерны, а LSTM моделирует долгосрочные зависимости. Применяется для прогнозирования направлений long/short на временных рядах с богатым набором индикаторов.

## Ключевые особенности
- CNN-слои выделяют высокочастотные и локальные закономерности в окнах данных.
- LSTM-слои агрегируют извлечённые признаки во временном разрезе.
- Гибкость настройки для разных таймфреймов и горизонтов прогнозирования.

## Типичные гиперпараметры
- Свёрточный блок: `num_filters`, `kernel_size`, `stride`, `padding`, `activation`.
- Рекуррентный блок: `hidden_size`, `num_layers`, `dropout`.
- Общие: `batch_size`, `sequence_length`, `learning_rate`, `optimizer`, `regularization`.

## Требования к данным
- Подготовка окон фиксированной длины; нормализация признаков.
- Обеспечение каузальности: формирование окон без использования будущих наблюдений.
- Разметка таргетов для выбранного режима (long-only, short-only, long+short).

## Метрики и валидация
- Accuracy, F1, ROC-AUC; трейдинговые метрики (Sharpe, Profit Factor, Hit Rate).
- Walk-forward/expanding window.
- Мониторинг валидационного лосса и метрик, ранняя остановка.

## Интеграция в конвейер
- Реализация на PyTorch с интерфейсом `fit/predict/predict_proba`.
- Хранение конфигурации свёрточных и LSTM-блоков, весов модели, статистик нормализации.
- Логирование активаций и фильтров для анализа (опционально).

## Ограничения и рекомендации
- Требует тщательного подбора комбинации свёрточных и рекуррентных параметров.
- Может переобучаться на малых выборках; использовать регуляризацию и dropout.
- Сравнивать с чистыми LSTM/TCN/Transformer моделями для оценки выгоды гибрида.
